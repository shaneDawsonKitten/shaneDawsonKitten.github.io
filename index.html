<?php
// Check if form is submitted
if ($_SERVER["REQUEST_METHOD"] == "POST") {
    // Get user input from the form
    $userText = isset($_POST['user_text']) ? $_POST['user_text'] : '';

    // Create image resource
    $image = imagecreatefrompng("image.png");

    // Allocate colors
    $white = imagecolorallocate($image, 255, 255, 255);
    $black = imagecolorallocate($image, 0, 0, 0);

    // Add user text to image
    imagestring($image, 5, 10, 10, $userText, $black);

    // Output image to a file
    $outputFile = "output_image.png";
    imagepng($image, $outputFile);

    // Free up memory
    imagedestroy($image);

    // Provide a link for the user to download the image
    echo "<p>Image generated successfully! Click the link to download:</p>";
    echo "<a href='$outputFile' download>Download Image</a>";
} else {
    // Display the HTML form if it's not submitted
    ?>
    <!DOCTYPE html>
    <html>
    <head>
        <title>Text on Image Form</title>
    </head>
    <body>
        <form method="post" action="<?php echo $_SERVER['PHP_SELF']; ?>">
            <label for="user_text">Enter Text:</label>
            <input type="text" name="user_text" id="user_text" required>
            <input type="submit" value="Generate Image">
        </form>
    </body>
    </html>
    <?php
}
?>
